#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸš€ Running pre-push checks..."

# Run full test suite
echo "ğŸ§ª Running full test suite..."

# Frontend tests
if [ -d "frontend" ]; then
  echo "ğŸ“¦ Frontend tests..."
  cd frontend
  npm test -- --ci --coverage --watchAll=false || {
    echo "âŒ Frontend tests failed"
    exit 1
  }
  cd ..
fi

# Backend tests
if [ -d "backend" ]; then
  echo "ğŸ Backend tests..."
  cd backend
  if [ -d "venv" ]; then
    source venv/bin/activate
  elif [ -d ".venv" ]; then
    source .venv/bin/activate
  fi
  python manage.py test || {
    echo "âŒ Backend tests failed"
    exit 1
  }
  cd ..
fi

echo "âœ… All pre-push checks passed!"
exit 0

